<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moodboard Content Manager</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%);
            color: white;
            min-height: 100vh;
        }
        
        .app {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .header h1 {
            background: linear-gradient(45deg, #64ffda, #64b5f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            height: calc(100vh - 200px);
        }
        
        .sidebar {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .content-area {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow-y: auto;
        }
        
        .add-item-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, #64ffda, #64b5f6);
            border: none;
            border-radius: 10px;
            color: black;
            font-weight: bold;
            cursor: pointer;
            margin-bottom: 20px;
            transition: transform 0.2s;
        }
        
        .add-item-btn:hover {
            transform: translateY(-2px);
        }
        
        .media-types {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .media-type-btn {
            padding: 10px;
            background: rgba(100, 255, 218, 0.1);
            border: 1px solid rgba(100, 255, 218, 0.3);
            border-radius: 8px;
            color: #64ffda;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
        }
        
        .media-type-btn:hover {
            background: rgba(100, 255, 218, 0.2);
        }
        
        .media-type-btn.active {
            background: rgba(100, 255, 218, 0.3);
            border-color: #64ffda;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #64ffda;
            font-weight: 500;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            color: white;
            font-size: 14px;
        }
        
        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .file-drop-zone {
            border: 2px dashed rgba(100, 255, 218, 0.5);
            border-radius: 10px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 15px;
        }
        
        .file-drop-zone:hover,
        .file-drop-zone.dragover {
            border-color: #64ffda;
            background: rgba(100, 255, 218, 0.1);
        }
        
        .items-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .item-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .item-card:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateX(5px);
        }
        
        .item-card.selected {
            border-color: #64ffda;
            background: rgba(100, 255, 218, 0.1);
        }
        
        .item-card h4 {
            color: #64ffda;
            margin-bottom: 5px;
        }
        
        .item-card p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 12px;
            line-height: 1.4;
        }
        
        .preview-area {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .preview-content img {
            max-width: 100%;
            max-height: 300px;
            border-radius: 8px;
        }
        
        .preview-content video {
            max-width: 100%;
            max-height: 300px;
            border-radius: 8px;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #64ffda, #64b5f6);
            color: black;
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .btn-danger {
            background: rgba(255, 107, 107, 0.2);
            color: #ff6b6b;
            border: 1px solid rgba(255, 107, 107, 0.5);
        }
        
        .btn:hover {
            transform: translateY(-2px);
        }
        
        .export-section {
            background: rgba(100, 255, 218, 0.1);
            border: 1px solid rgba(100, 255, 218, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .export-section h3 {
            color: #64ffda;
            margin-bottom: 15px;
        }
        
        .file-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding: 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
        }
        
        .size-indicators {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .size-btn {
            padding: 5px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            color: white;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }
        
        .size-btn.active {
            background: rgba(100, 255, 218, 0.3);
            border-color: #64ffda;
            color: #64ffda;
        }
        
        .social-embed-preview {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .url-preview {
            display: flex;
            gap: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .url-preview img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 5px;
        }
        
        .url-preview-content h4 {
            color: #64ffda;
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .url-preview-content p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 12px;
            line-height: 1.4;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        function MoodboardManager() {
            const [items, setItems] = useState([]);
            const [selectedItem, setSelectedItem] = useState(null);
            const [activeMediaType, setActiveMediaType] = useState('text');
            const [formData, setFormData] = useState({
                type: 'text',
                title: '',
                content: '',
                author: '',
                url: '',
                size: 'medium',
                color: '#64ffda'
            });
            const [previewData, setPreviewData] = useState(null);
            const fileInputRef = useRef(null);

            const mediaTypes = [
                { id: 'text', label: '📝 Text', icon: '📝' },
                { id: 'quote', label: '💭 Quote', icon: '💭' },
                { id: 'link', label: '🔗 Link', icon: '🔗' },
                { id: 'image', label: '🖼️ Image', icon: '🖼️' },
                { id: 'video', label: '🎥 Video', icon: '🎥' },
                { id: 'social', label: '📱 Social', icon: '📱' }
            ];

            const colorOptions = [
                { name: 'Cyan', value: '#64ffda' },
                { name: 'Blue', value: '#64b5f6' },
                { name: 'Purple', value: '#ba68c8' },
                { name: 'Pink', value: '#f48fb1' },
                { name: 'Orange', value: '#ffb74d' },
                { name: 'Green', value: '#81c784' },
                { name: 'Red', value: '#e57373' },
                { name: 'Yellow', value: '#fff176' }
            ];

            // Load saved items
            useEffect(() => {
                const savedItems = localStorage.getItem('moodboard-items');
                if (savedItems) {
                    setItems(JSON.parse(savedItems));
                }
            }, []);

            // Save items to localStorage
            const saveItems = (newItems) => {
                setItems(newItems);
                localStorage.setItem('moodboard-items', JSON.stringify(newItems));
            };

            // Handle file upload
            const handleFileUpload = (file) => {
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (e) => {
                    const result = e.target.result;
                    setPreviewData({
                        type: file.type.startsWith('image/') ? 'image' : 'video',
                        url: result,
                        name: file.name,
                        size: file.size
                    });
                    
                    setFormData(prev => ({
                        ...prev,
                        content: result,
                        title: prev.title || file.name.replace(/\.[^/.]+$/, "")
                    }));
                };
                reader.readAsDataURL(file);
            };

            // Handle drag and drop
            const handleDrop = (e) => {
                e.preventDefault();
                const files = Array.from(e.dataTransfer.files);
                if (files[0]) {
                    handleFileUpload(files[0]);
                }
            };

            // Extract social media info
            const extractSocialInfo = async (url) => {
                try {
                    // This would normally use an API service like Embedly or custom scraper
                    // For demo purposes, we'll simulate the data
                    const platform = url.includes('twitter.com') || url.includes('x.com') ? 'Twitter' :
                                   url.includes('instagram.com') ? 'Instagram' :
                                   url.includes('youtube.com') ? 'YouTube' :
                                   url.includes('tiktok.com') ? 'TikTok' : 'Unknown';
                    
                    setPreviewData({
                        type: 'social',
                        platform,
                        url,
                        title: `${platform} Post`,
                        description: 'Social media content preview'
                    });
                } catch (error) {
                    console.error('Error extracting social info:', error);
                }
            };

            // Handle URL preview
            const handleUrlPreview = async (url) => {
                if (!url) return;
                
                // Simulate URL preview (normally would use an API)
                setPreviewData({
                    type: 'url',
                    url,
                    title: 'Web Page Title',
                    description: 'Preview description of the web page content',
                    image: 'https://via.placeholder.com/120x120'
                });
            };

            // Add new item
            const addItem = () => {
                const newItem = {
                    id: Date.now().toString(),
                    ...formData,
                    createdAt: new Date().toISOString()
                };
                
                const newItems = [newItem, ...items];
                saveItems(newItems);
                
                // Reset form
                setFormData({
                    type: activeMediaType,
                    title: '',
                    content: '',
                    author: '',
                    url: '',
                    size: 'medium',
                    color: '#64ffda'
                });
                setPreviewData(null);
            };

            // Update item
            const updateItem = () => {
                const newItems = items.map(item => 
                    item.id === selectedItem.id 
                        ? { ...selectedItem, ...formData, updatedAt: new Date().toISOString() }
                        : item
                );
                saveItems(newItems);
                setSelectedItem(null);
            };

            // Delete item
            const deleteItem = (id) => {
                const newItems = items.filter(item => item.id !== id);
                saveItems(newItems);
                if (selectedItem?.id === id) {
                    setSelectedItem(null);
                }
            };

            // Export to JSON
            const exportToJSON = () => {
                const dataToExport = {
                    items,
                    exportDate: new Date().toISOString(),
                    version: '1.0'
                };
                
                const blob = new Blob([JSON.stringify(dataToExport, null, 2)], {
                    type: 'application/json'
                });
                
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `moodboard-${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                URL.revokeObjectURL(url);
            };

            // Generate IPFS-ready files
            const generateIPFSFiles = () => {
                // Create the data structure your Next.js app expects
                const ipfsData = {
                    moodboardItems: items.map(item => ({
                        id: item.id,
                        type: item.type,
                        content: item.content,
                        title: item.title,
                        author: item.author,
                        url: item.url,
                        color: item.color,
                        size: item.size
                    })),
                    lastUpdated: new Date().toISOString()
                };

                // Create deployment manifest
                const deploymentManifest = {
                    files: ['moodboard.json'],
                    timestamp: new Date().toISOString(),
                    itemCount: items.length,
                    instructions: {
                        step1: "Copy moodboard.json to your Next.js project's data/ folder",
                        step2: "Run 'npm run build' to generate static files",
                        step3: "Upload the 'out/' folder to Pinata",
                        step4: "Update your ENS content hash with the new IPFS hash"
                    }
                };

                // Download both files
                const downloadFile = (data, filename) => {
                    const blob = new Blob([JSON.stringify(data, null, 2)], {
                        type: 'application/json'
                    });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = filename;
                    a.click();
                    URL.revokeObjectURL(url);
                };

                downloadFile(ipfsData, 'moodboard.json');
                setTimeout(() => downloadFile(deploymentManifest, 'deployment-manifest.json'), 500);
            };

            return (
                <div className="app">
                    <div className="header">
                        <h1>🎨 Moodboard Content Manager</h1>
                        <p>Create and manage rich media content for your 3D moodboard</p>
                    </div>

                    <div className="main-content">
                        {/* Sidebar */}
                        <div className="sidebar">
                            <button className="add-item-btn" onClick={addItem}>
                                ✨ Add New Item
                            </button>

                            {/* Media Type Selection */}
                            <div className="media-types">
                                {mediaTypes.map(type => (
                                    <button
                                        key={type.id}
                                        className={`media-type-btn ${activeMediaType === type.id ? 'active' : ''}`}
                                        onClick={() => {
                                            setActiveMediaType(type.id);
                                            setFormData(prev => ({ ...prev, type: type.id }));
                                        }}
                                    >
                                        {type.label}
                                    </button>
                                ))}
                            </div>

                            {/* Form Fields */}
                            <div className="form-group">
                                <label>Title</label>
                                <input
                                    type="text"
                                    value={formData.title}
                                    onChange={(e) => setFormData(prev => ({ ...prev, title: e.target.value }))}
                                    placeholder="Enter title..."
                                />
                            </div>

                            {activeMediaType === 'quote' && (
                                <div className="form-group">
                                    <label>Author</label>
                                    <input
                                        type="text"
                                        value={formData.author}
                                        onChange={(e) => setFormData(prev => ({ ...prev, author: e.target.value }))}
                                        placeholder="Quote author..."
                                    />
                                </div>
                            )}

                            {(activeMediaType === 'link' || activeMediaType === 'social') && (
                                <div className="form-group">
                                    <label>URL</label>
                                    <input
                                        type="url"
                                        value={formData.url}
                                        onChange={(e) => {
                                            setFormData(prev => ({ ...prev, url: e.target.value }));
                                            if (activeMediaType === 'social') {
                                                extractSocialInfo(e.target.value);
                                            } else {
                                                handleUrlPreview(e.target.value);
                                            }
                                        }}
                                        placeholder="https://..."
                                    />
                                </div>
                            )}

                            {(activeMediaType === 'image' || activeMediaType === 'video') && (
                                <div className="form-group">
                                    <label>Upload File</label>
                                    <div
                                        className="file-drop-zone"
                                        onClick={() => fileInputRef.current?.click()}
                                        onDrop={handleDrop}
                                        onDragOver={(e) => e.preventDefault()}
                                    >
                                        <p>📁 Click or drag files here</p>
                                        <p style={{fontSize: '12px', opacity: 0.7}}>
                                            {activeMediaType === 'image' ? 'Images: JPG, PNG, GIF, WebP' : 'Videos: MP4, MOV, WebM'}
                                        </p>
                                    </div>
                                    <input
                                        ref={fileInputRef}
                                        type="file"
                                        style={{display: 'none'}}
                                        accept={activeMediaType === 'image' ? 'image/*' : 'video/*'}
                                        onChange={(e) => handleFileUpload(e.target.files[0])}
                                    />
                                </div>
                            )}

                            <div className="form-group">
                                <label>Content</label>
                                <textarea
                                    value={formData.content}
                                    onChange={(e) => setFormData(prev => ({ ...prev, content: e.target.value }))}
                                    placeholder="Enter content, description, or notes..."
                                />
                            </div>

                            {/* Size Selection */}
                            <div className="form-group">
                                <label>Size</label>
                                <div className="size-indicators">
                                    {['small', 'medium', 'large'].map(size => (
                                        <button
                                            key={size}
                                            className={`size-btn ${formData.size === size ? 'active' : ''}`}
                                            onClick={() => setFormData(prev => ({ ...prev, size }))}
                                        >
                                            {size}
                                        </button>
                                    ))}
                                </div>
                            </div>

                            {/* Color Selection */}
                            <div className="form-group">
                                <label>Theme Color</label>
                                <select
                                    value={formData.color}
                                    onChange={(e) => setFormData(prev => ({ ...prev, color: e.target.value }))}
                                >
                                    {colorOptions.map(color => (
                                        <option key={color.value} value={color.value}>
                                            {color.name}
                                        </option>
                                    ))}
                                </select>
                            </div>

                            {/* Items List */}
                            <div className="items-list">
                                <h3 style={{marginBottom: '10px', color: '#64ffda'}}>
                                    Items ({items.length})
                                </h3>
                                {items.map(item => (
                                    <div
                                        key={item.id}
                                        className={`item-card ${selectedItem?.id === item.id ? 'selected' : ''}`}
                                        onClick={() => {
                                            setSelectedItem(item);
                                            setFormData(item);
                                        }}
                                    >
                                        <h4>{item.title || 'Untitled'}</h4>
                                        <p>{item.type} • {item.size}</p>
                                        <p>{item.content?.substring(0, 50)}...</p>
                                    </div>
                                ))}
                            </div>
                        </div>

                        {/* Content Area */}
                        <div className="content-area">
                            {/* Preview */}
                            <div className="preview-area">
                                {previewData ? (
                                    <div className="preview-content">
                                        {previewData.type === 'image' && (
                                            <img src={previewData.url} alt="Preview" />
                                        )}
                                        {previewData.type === 'video' && (
                                            <video src={previewData.url} controls />
                                        )}
                                        {previewData.type === 'social' && (
                                            <div className="social-embed-preview">
                                                <h4>{previewData.platform} Post</h4>
                                                <p>{previewData.title}</p>
                                                <p style={{fontSize: '12px', opacity: 0.7}}>
                                                    {previewData.url}
                                                </p>
                                            </div>
                                        )}
                                        {previewData.type === 'url' && (
                                            <div className="url-preview">
                                                <img src={previewData.image} alt="" />
                                                <div className="url-preview-content">
                                                    <h4>{previewData.title}</h4>
                                                    <p>{previewData.description}</p>
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                ) : (
                                    <p style={{color: 'rgba(255,255,255,0.5)'}}>
                                        {activeMediaType === 'image' || activeMediaType === 'video' 
                                            ? 'Upload a file to see preview'
                                            : 'Enter content to see preview'
                                        }
                                    </p>
                                )}
                            </div>

                            {/* Action Buttons */}
                            <div className="action-buttons">
                                {selectedItem ? (
                                    <>
                                        <button className="btn btn-primary" onClick={updateItem}>
                                            💾 Update Item
                                        </button>
                                        <button className="btn btn-secondary" onClick={() => setSelectedItem(null)}>
                                            ✖️ Cancel
                                        </button>
                                        <button className="btn btn-danger" onClick={() => deleteItem(selectedItem.id)}>
                                            🗑️ Delete
                                        </button>
                                    </>
                                ) : (
                                    <button className="btn btn-primary" onClick={addItem}>
                                        ➕ Add Item
                                    </button>
                                )}
                            </div>

                            {/* Export Section */}
                            <div className="export-section">
                                <h3>🚀 Deploy to IPFS</h3>
                                <div className="file-info">
                                    <span>Items ready for deployment</span>
                                    <span style={{color: '#64ffda'}}>{items.length} items</span>
                                </div>
                                <div className="file-info">
                                    <span>Estimated file size</span>
                                    <span style={{color: '#64ffda'}}>
                                        {Math.round(JSON.stringify(items).length / 1024)}KB
                                    </span>
                                </div>
                                
                                <div className="action-buttons">
                                    <button className="btn btn-primary" onClick={generateIPFSFiles}>
                                        📦 Generate IPFS Files
                                    </button>
                                    <button className="btn btn-secondary" onClick={exportToJSON}>
                                        💾 Export Backup
                                    </button>
                                </div>
                                
                                <div style={{marginTop: '15px', fontSize: '12px', color: 'rgba(255,255,255,0.7)'}}>
                                    <p>• Downloads moodboard.json for your Next.js project</p>
                                    <p>• Includes deployment instructions</p>
                                    <p>• Ready for Pinata upload</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<MoodboardManager />, document.getElementById('root'));
    </script>
</body>
</html>